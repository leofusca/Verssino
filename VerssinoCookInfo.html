<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Infograf√≠a Interactiva | VERSSINO SOLES</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
            color: #073B4C;
            padding-top: 6rem;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 320px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 384px;
            }
        }
        .flow-step {
            flex-basis: 150px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        .flow-step:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);
        }
        .flow-arrow {
            font-size: 2.5rem;
            line-height: 1;
            color: #9ca3af;
        }
        .kpi-card {
            background-color: white;
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: background-color 0.2s;
        }
        .kpi-card:hover {
            background-color: #f9fafb;
        }
        .brand-brown { color: #8B5E3C; }
        .brand-beige { background-color: #F5EADD; }
        .nav-link {
            transition: all 0.2s;
            cursor: pointer;
        }
        .nav-link.active {
            border-bottom: 3px solid #FF6B6B;
            font-weight: 700;
            color: #073B4C;
        }
        .modal {
            background-color: rgba(7, 59, 76, 0.9);
            z-index: 50;
        }
        .modal-content {
            max-height: 80vh;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Fija: Navigation Bar -->
    <nav id="navbar" class="fixed top-0 left-0 right-0 bg-white shadow-lg z-40">
        <div class="container mx-auto max-w-6xl px-4 md:px-8 flex justify-center space-x-6 py-4">
            <a onclick="scrollToSection('kpis')" class="nav-link text-gray-500 hover:text-red-500 pb-2">KPIs</a>
            <a onclick="scrollToSection('formulation')" class="nav-link text-gray-500 hover:text-red-500 pb-2">F√≥rmula</a>
            <a onclick="scrollToSection('qc')" class="nav-link text-gray-500 hover:text-red-500 pb-2">Calidad (QC)</a>
            <a onclick="scrollToSection('process')" class="nav-link text-gray-500 hover:text-red-500 pb-2">Proceso</a>
            <a onclick="scrollToSection('packaging')" class="nav-link text-gray-500 hover:text-red-500 pb-2">Empaque</a>
        </div>
    </nav>

    <div class="container mx-auto max-w-6xl p-4 md:p-8">

        <header class="text-center my-8 md:my-12">
            <h1 class="text-5xl md:text-6xl font-extrabold brand-brown">VERSSINO SOLES</h1>
            <p class="text-2xl md:text-3xl mt-2 font-semibold" style="color: #118AB2;">An√°lisis T√©cnico Interactivo</p>
            <p class="max-w-3xl mx-auto mt-4 text-base md:text-lg text-gray-700">
                Explore las especificaciones t√©cnicas, formulaciones cr√≠ticas y puntos de control de calidad que aseguran la textura y vida √∫til del producto "SOLES".
            </p>
        </header>

        <main class="space-y-16">

            <section id="kpis" class="scroll-mt-24 bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center mb-2" style="color: #118AB2;">1. Key Performance Indicators (KPIs)</h2>
                <p class="text-center text-gray-600 mb-8">Par√°metros clave para garantizar una experiencia de consumidor premium y consistente.</p>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 md:gap-6">
                    <div class="kpi-card border-b-4 border-red-500">
                        <span class="text-sm font-semibold text-gray-500">Di√°metro Objetivo</span>
                        <span class="block text-4xl font-extrabold text-gray-800 mt-2">80-90</span>
                        <span class="block text-lg text-gray-600">mm</span>
                    </div>
                    <div class="kpi-card border-b-4 border-yellow-500">
                        <span class="text-sm font-semibold text-gray-500">Peso Individual</span>
                        <span class="block text-4xl font-extrabold text-gray-800 mt-2">24<span class="text-2xl">g</span></span>
                        <span class="block text-lg text-gray-600">¬± 2g</span>
                    </div>
                    <div class="kpi-card border-b-4 border-green-500">
                        <span class="text-sm font-semibold text-gray-500">Espesor Final</span>
                        <span class="block text-4xl font-extrabold text-gray-800 mt-2">6-9</span>
                        <span class="block text-lg text-gray-600">mm</span>
                    </div>
                    <div class="kpi-card border-b-4 border-blue-500">
                        <span class="text-sm font-semibold text-gray-500">Vida √ötil Estimada</span>
                        <span class="block text-4xl font-extrabold text-gray-800 mt-2">3-6</span>
                        <span class="block text-lg text-gray-600">Meses</span>
                    </div>
                </div>
            </section>

            <section id="formulation" class="scroll-mt-24">
                <h2 class="text-3xl font-bold text-center mb-6" style="color: #06D6A0;">2. An√°lisis de Formulaci√≥n</h2>
                <div class="bg-white rounded-xl shadow-lg p-6 md:p-8">
                    <p class="text-gray-600 mb-6">Explore la composici√≥n exacta del producto. Use el selector para alternar entre el **Porcentaje de Panificaci√≥n** (usado internamente, basado en la harina) y el **Porcentaje de Masa** (peso real por ingrediente).</p>
                    
                    <div class="flex justify-center mb-6">
                        <button id="toggleDataBtn" class="bg-red-500 text-white font-semibold py-2 px-6 rounded-full shadow-md hover:bg-red-600 transition duration-200">
                            Mostrar Porcentaje de Masa Real
                        </button>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h3 class="text-2xl font-bold mb-4 brand-brown text-center">A. Oblea de Rejilla</h3>
                            <div class="chart-container" style="height: 350px;">
                                <canvas id="obleaChart"></canvas>
                            </div>
                            <p class="text-sm text-gray-500 mt-4 px-2">El perfil arom√°tico incluye 0.6% de canela cr√≠tica. La Oblea, al ser la fase seca, est√° dise√±ada para una actividad de agua ($a_w$) extremadamente baja (0.2-0.4).</p>
                        </div>
                        <div>
                            <h3 class="text-2xl font-bold mb-4 brand-brown text-center">B. Relleno de Dulce de Leche</h3>
                            <div class="chart-container" style="height: 350px;">
                                <canvas id="rellenoChart"></canvas>
                            </div>
                            <p class="text-sm text-gray-500 mt-4 px-2">El relleno es DDL Repostero estabilizado (Glucosa) para reducir el $a_w$, prevenir la cristalizaci√≥n y mantener una viscosidad adecuada para el dosificado.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="qc" class="scroll-mt-24 bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center mb-2" style="color: #118AB2;">3. Control de Calidad: Actividad de Agua ($a_w$)</h2>
                <p class="text-center text-gray-600 mb-8 max-w-3xl mx-auto">La medici√≥n de $a_w$ es el control de calidad m√°s cr√≠tico. Si el $a_w$ del relleno excede 0.85, se compromete la textura crujiente de la oblea y se reduce dr√°sticamente la vida √∫til del producto.</p>
                <div class="chart-container" style="height: 300px;">
                    <canvas id="qcChart"></canvas>
                </div>
            </section>

            <section id="process" class="scroll-mt-24 bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold text-center mb-4" style="color: #FF6B6B;">4. Proceso de Producci√≥n (8 Etapas)</h2>
                <p class="text-center text-gray-600 mb-10">Flujo de producci√≥n estandarizado. Haga clic en los pasos **Cr√≠ticos (Rojos)** para ver los detalles del PCC.</p>
                
                <div class="flex flex-col md:flex-row flex-wrap justify-center items-center gap-x-2 gap-y-6">
                    
                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">1.</span>
                        <h4 class="font-semibold mt-1">Preparaci√≥n Masa</h4>
                        <p class="text-xs text-gray-600">Mezcla y reposo 30 min.</p>
                    </div>
                    
                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">2.</span>
                        <h4 class="font-semibold mt-1">Cocci√≥n Obleas</h4>
                        <p class="text-xs text-gray-600">45-70 seg. en plancha.</p>
                    </div>

                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div id="ccp1" onclick="showCCP(1)" class="flow-step bg-red-100 p-4 rounded-lg shadow-inner text-center border-2 border-red-500">
                        <span class="text-2xl font-bold text-red-600">3.</span>
                        <h4 class="font-semibold mt-1 text-red-700">PCC 1: Corte/Divisi√≥n</h4>
                        <p class="text-xs text-red-600">(CR√çTICO)</p>
                    </div>
                    
                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">4.</span>
                        <h4 class="font-semibold mt-1">Preparar Relleno</h4>
                        <p class="text-xs text-gray-600">Homogeneizar a 45-55¬∞C.</p>
                    </div>
                    
                    <span class="w-full h-0 md:hidden"></span>

                    <span class="flow-arrow hidden lg:block">&rarr;</span>
                    <span class="flow-arrow block lg:hidden w-full text-center">&darr;</span>

                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">5.</span>
                        <h4 class="font-semibold mt-1">Dosificado y Cerrado</h4>
                        <p class="text-xs text-gray-600">Aplicar 12-16g.</p>
                    </div>

                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div id="ccp2" onclick="showCCP(2)" class="flow-step bg-red-100 p-4 rounded-lg shadow-inner text-center border-2 border-red-500">
                        <span class="text-2xl font-bold text-red-600">6.</span>
                        <h4 class="font-semibold mt-1 text-red-700">PCC 2: Enfriamiento</h4>
                        <p class="text-xs text-red-600">(CR√çTICO)</p>
                    </div>

                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">7.</span>
                        <h4 class="font-semibold mt-1">Empaquetado</h4>
                        <p class="text-xs text-gray-600">Sello t√©rmico en film.</p>
                    </div>

                    <span class="flow-arrow hidden md:block">&rarr;</span>
                    <span class="flow-arrow block md:hidden">&darr;</span>

                    <div class="flow-step bg-gray-100 p-4 rounded-lg shadow-inner text-center">
                        <span class="text-2xl font-bold">8.</span>
                        <h4 class="font-semibold mt-1">Etiquetado</h4>
                        <p class="text-xs text-gray-600">Lote y vencimiento.</p>
                    </div>
                </div>
            </section>

            <section id="packaging" class="scroll-mt-24 bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h2 class="text-3xl font-bold mb-2" style="color: #118AB2;">5. Requisitos de Packaging (6.0)</h2>
                <p class="text-gray-600 mb-8">El empaque cumple una doble funci√≥n: proteger el producto (barrera t√©cnica) y comunicar la identidad de la marca (dise√±o).</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div class="flex flex-col items-center text-center p-4 border-l-4 border-yellow-500">
                        <span class="text-5xl mb-3">üõ°Ô∏è</span>
                        <h4 class="font-semibold text-lg">Film de Alta Barrera</h4>
                        <p class="text-gray-600 text-sm">Uso de PA/PE o PET/PE metalizado con baja Tasa de Transmisi√≥n de Vapor de Agua (WVTR) para maximizar la protecci√≥n contra la humedad y el ox√≠geno.</p>
                    </div>
                    <div class="flex flex-col items-center text-center p-4 border-l-4 border-red-500">
                        <span class="text-5xl mb-3">‚òÄÔ∏è</span>
                        <h4 class="font-semibold text-lg">Dise√±o e Identidad</h4>
                        <p class="text-gray-600 text-sm">Debe replicar la est√©tica visual de VERSSINO, incluyendo el Fileteado Argentino, el Sol de Mayo y una ventana transparente para ver el producto.</p>
                    </div>
                    <div class="flex flex-col items-center text-center p-4 border-l-4 border-green-500">
                        <span class="text-5xl mb-3">‚öñÔ∏è</span>
                        <h4 class="font-semibold text-lg">Etiquetado Legal</h4>
                        <p class="text-gray-600 text-sm">Inclusi√≥n obligatoria de ingredientes, al√©rgenos (Gluten, Leche, Huevo), RNPA/RNE, lote y fecha de vencimiento.</p>
                    </div>
                </div>
            </section>

        </main>

        <footer class="text-center mt-12 py-8 border-t border-gray-300">
            <p class="text-xl font-semibold brand-brown">VERSSINO SOLES</p>
            <p class="text-lg text-gray-600">Documento T√©cnico Interactivo v1.1</p>
        </footer>

    </div>

    <!-- Modal para Puntos Cr√≠ticos de Control -->
    <div id="ccpModal" class="modal fixed inset-0 hidden items-center justify-center p-4">
        <div id="modalContent" class="modal-content bg-white rounded-xl p-8 shadow-2xl w-full max-w-lg overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 id="modalTitle" class="text-3xl font-bold" style="color: #FF6B6B;"></h3>
                <button onclick="closeCCPModal()" class="text-gray-500 text-3xl font-light hover:text-gray-900 transition">&times;</button>
            </div>
            <p id="modalDescription" class="text-gray-700 mb-6"></p>
            <div class="space-y-4">
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-yellow-500">
                    <p class="font-semibold">Tolerancia M√≠nima:</p>
                    <p id="modalTolerance" class="text-gray-700"></p>
                </div>
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-blue-500">
                    <p class="font-semibold">Riesgo Asociado:</p>
                    <p id="modalRisk" class="text-gray-700"></p>
                </div>
                <div class="p-3 bg-gray-50 rounded-lg border-l-4 border-green-500">
                    <p class="font-semibold">Monitoreo:</p>
                    <p id="modalMonitoring" class="text-gray-700"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const paletaVibrante = {
            red: '#FF6B6B',
            yellow: '#FFD166',
            green: '#06D6A0',
            blue: '#118AB2',
            darkBlue: '#073B4C'
        };

        const paletaMarca = {
            brown: '#8B5E3C',
            beige: '#F5EADD',
            darkBrown: '#6d4c41'
        };
        
        const mandatoryTooltipCallback = {
            title: function(tooltipItems) {
                const item = tooltipItems[0];
                let label = item.chart.data.labels[item.dataIndex];
                if (Array.isArray(label)) {
                    return label.join(' ');
                } else {
                    return label;
                }
            }
        };

        function wrapLabel(label, maxWidth = 16) {
            if (label.length <= maxWidth) {
                return label;
            }
            const words = label.split(' ');
            const lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine.trim());
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine.length > 0) {
                lines.push(currentLine.trim());
            }
            return lines;
        }

        const obleaLabels = [
            'Harina (000)', 
            'Manteca', 
            'Az√∫car Morena', 
            'Leche Entera', 
            'Huevo',
            'Sal',
            'Vainilla',
            wrapLabel('Levadura Seca Activa'),
            'Canela'
        ].map(l => Array.isArray(l) ? l : wrapLabel(l));

        const obleaDataBaker = [100.0, 40.0, 30.0, 20.0, 10.0, 1.2, 1.0, 0.8, 0.6];
        const obleaDataMass = [60.0, 24.0, 18.0, 12.0, 6.0, 0.72, 0.6, 0.48, 0.36]; 

        const rellenoLabels = [
            wrapLabel('Dulce de Leche Repostero'), 
            wrapLabel('Jarabe de Glucosa'), 
            wrapLabel('Manteca (sin sal)'), 
            wrapLabel('Leche en Polvo'),
            'Otros (Sal, Vainilla)'
        ];

        const rellenoData = [81.9, 8.2, 4.7, 4.7, 0.5];

        let obleaChartInstance;
        let rellenoChartInstance;

        function renderCharts(isMassPercentage = false) {
            
            const obleaData = isMassPercentage ? obleaDataMass : obleaDataBaker;
            const obleaTitle = isMassPercentage ? 'Porcentaje de Masa Real (%)' : '% de Panificaci√≥n (Base Harina=100%)';
            const obleaColor = isMassPercentage ? paletaVibrante.blue : paletaVibrante.yellow;

            if (obleaChartInstance) {
                obleaChartInstance.destroy();
            }

            const ctxOblea = document.getElementById('obleaChart').getContext('2d');
            obleaChartInstance = new Chart(ctxOblea, {
                type: 'bar',
                data: {
                    labels: obleaLabels,
                    datasets: [{
                        label: obleaTitle,
                        data: obleaData,
                        backgroundColor: [
                            paletaMarca.beige,
                            paletaVibrante.yellow,
                            paletaMarca.brown,
                            '#e0e0e0',
                            paletaVibrante.yellow,
                            '#bdbdbd',
                            '#eeeeee',
                            '#e0e0e0',
                            paletaVibrante.red
                        ].map(color => isMassPercentage ? color : color),
                        borderColor: isMassPercentage ? paletaVibrante.darkBlue : paletaMarca.darkBrown,
                        borderWidth: 2
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: { display: true, text: obleaTitle, color: paletaVibrante.darkBlue },
                            ticks: { color: paletaVibrante.darkBlue },
                            grid: { display: false }
                        },
                        y: {
                            ticks: { color: paletaVibrante.darkBlue, font: { size: 10 } },
                            grid: { display: true, drawOnChartArea: false }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: { callbacks: mandatoryTooltipCallback }
                    }
                }
            });

            if (rellenoChartInstance) {
                rellenoChartInstance.destroy();
            }

            const ctxRelleno = document.getElementById('rellenoChart').getContext('2d');
            rellenoChartInstance = new Chart(ctxRelleno, {
                type: 'doughnut',
                data: {
                    labels: rellenoLabels,
                    datasets: [{
                        label: 'Composici√≥n del Relleno',
                        data: rellenoData,
                        backgroundColor: [
                            paletaMarca.brown, 
                            paletaVibrante.blue, 
                            paletaVibrante.yellow,
                            paletaMarca.beige,
                            '#bdbdbd'
                        ],
                        borderColor: '#ffffff',
                        borderWidth: 4,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: paletaVibrante.darkBlue,
                                font: { size: 11 },
                                padding: 15
                            }
                        },
                        tooltip: { callbacks: mandatoryTooltipCallback }
                    }
                }
            });

            // QC Chart (Static as it's a fixed CC)
            const ctxQC = document.getElementById('qcChart').getContext('2d');
            new Chart(ctxQC, {
                type: 'bar',
                data: {
                    labels: [wrapLabel('Aw Oblea (Galleta)'), wrapLabel('Aw Relleno (DDL)')],
                    datasets: [
                        {
                            label: 'Rango Ideal',
                            data: [ [0.2, 0.4], [0.75, 0.80] ],
                            backgroundColor: paletaVibrante.green,
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            barPercentage: 0.6,
                            categoryPercentage: 0.7
                        },
                        {
                            label: 'L√≠mite (M√°x)',
                            data: [ [0.4, 0.45], [0.80, 0.85] ],
                            backgroundColor: paletaVibrante.red,
                            borderColor: '#ffffff',
                            borderWidth: 2,
                            barPercentage: 0.6,
                            categoryPercentage: 0.7
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 1.0,
                            title: { display: true, text: 'Actividad de Agua (aw)', color: paletaVibrante.darkBlue },
                            ticks: { color: paletaVibrante.darkBlue },
                            grid: { color: '#e0e0e0' }
                        },
                        x: {
                            ticks: { color: paletaVibrante.darkBlue, font: { size: 12 } },
                            grid: { display: false }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                color: paletaVibrante.darkBlue,
                                font: { size: 11 },
                                padding: 15
                            }
                        },
                        tooltip: {
                            callbacks: {
                                title: mandatoryTooltipCallback.title,
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.raw && Array.isArray(context.raw)) {
                                        label += `Rango ${context.raw[0]} - ${context.raw[1]}`;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }

        // Global state for formulation data toggle
        let isMassPercentage = false;

        document.getElementById('toggleDataBtn').addEventListener('click', () => {
            isMassPercentage = !isMassPercentage;
            document.getElementById('toggleDataBtn').textContent = isMassPercentage 
                ? 'Mostrar Porcentaje de Panificaci√≥n (Baker\'s %)' 
                : 'Mostrar Porcentaje de Masa Real';
            renderCharts(isMassPercentage);
        });

        // Interactive Process Flow (CCP Modal)
        const ccpData = {
            1: {
                title: "PCC 1: Corte y Divisi√≥n (Temperatura)",
                description: "Este es un punto de control de calidad cr√≠tico para asegurar la geometr√≠a y prevenir el agrietamiento de la oblea. El corte debe ocurrir cuando la oblea est√° en su estado m√°s maleable (a√∫n caliente).",
                tolerance: "Temperatura de la Oblea: 75¬∞C - 85¬∞C. Desviaci√≥n m√°x: 5¬∞C.",
                risk: "Corte tard√≠o o en fr√≠o: Quiebre excesivo de obleas, producto no apto, altos rechazos.",
                monitoring: "Monitoreo constante con term√≥metro infrarrojo en la l√≠nea de corte. Muestras cada 15 minutos."
            },
            2: {
                title: "PCC 2: Enfriamiento (Textura y Estabilidad)",
                description: "El enfriamiento r√°pido post-ensamblaje es vital. Permite que el relleno (DDL) se solidifique r√°pidamente y que la oblea alcance la rigidez final, minimizando la migraci√≥n de humedad.",
                tolerance: "Tiempo en t√∫nel de enfriamiento: 10 - 20 minutos. Temperatura de salida: M√°x 25¬∞C.",
                risk: "Enfriamiento insuficiente: Relleno suave (oozing), deformaci√≥n, y riesgo elevado de migraci√≥n de Aw, ablandando la oblea.",
                monitoring: "Medici√≥n de temperatura de producto en el centro de la l√≠nea. Verificaci√≥n visual del sellado."
            }
        };

        function showCCP(ccpId) {
            const data = ccpData[ccpId];
            if (data) {
                document.getElementById('modalTitle').textContent = data.title;
                document.getElementById('modalDescription').textContent = data.description;
                document.getElementById('modalTolerance').textContent = data.tolerance;
                document.getElementById('modalRisk').textContent = data.risk;
                document.getElementById('modalMonitoring').textContent = data.monitoring;
                document.getElementById('ccpModal').classList.remove('hidden');
                document.getElementById('ccpModal').classList.add('flex');
            }
        }

        function closeCCPModal() {
            document.getElementById('ccpModal').classList.add('hidden');
            document.getElementById('ccpModal').classList.remove('flex');
        }

        // Section scrolling and Navbar active state
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }

        const sections = ['kpis', 'formulation', 'qc', 'process', 'packaging'];
        const navLinks = document.querySelectorAll('.nav-link');

        function updateNavbar() {
            let currentSection = '';
            sections.forEach(id => {
                const section = document.getElementById(id);
                const rect = section.getBoundingClientRect();
                // Check if the section top is near the top of the viewport (taking navbar height into account)
                if (rect.top <= 100 && rect.bottom >= 100) {
                    currentSection = id;
                }
            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('onclick').includes(`'${currentSection}'`)) {
                    link.classList.add('active');
                }
            });
        }

        window.addEventListener('scroll', updateNavbar);
        window.addEventListener('load', () => {
            renderCharts(isMassPercentage);
            updateNavbar();
        });

    </script>
</body>
</html>
